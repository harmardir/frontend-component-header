{"version":3,"file":"index.js","names":["React","useEffect","useState","PropTypes","Checkpoint","ProductTour","forwardRef","_ref","ref","tours","tourValue","find","tour","enabled","_ref2","_ref2$checkpoints","checkpoints","startingIndex","onEscape","onEnd","tourOnDismiss","onDismiss","tourAdvanceButtonText","advanceButtonText","tourDismissButtonText","dismissButtonText","tourEndButtonText","endButtonText","_useState","_useState2","_slicedToArray","currentCheckpointData","setCurrentCheckpointData","_useState3","_useState4","index","setIndex","_useState5","_useState6","isTourEnabled","setIsTourEnabled","_useState7","_useState8","prunedCheckpoints","setPrunedCheckpoints","_ref3","title","body","onAdvance","placement","target","showDismissButton","pruneCheckpoints","checkpointList","checkpointsWithRenderedTargets","filter","checkpoint","document","querySelector","length","handleEsc","event","keyCode","global","addEventListener","removeEventListener","handleAdvance","handleDismiss","handleEnd","checkpointIndex","createElement","totalCheckpoints","defaultProps","undefined","propTypes","arrayOf","shape","node","func","oneOf","string","isRequired","bool","number","tourId"],"sources":["../../src/ProductTour/index.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport Checkpoint from './Checkpoint';\n\nconst ProductTour = React.forwardRef(({ tours }, ref) => {\n  const tourValue = tours.find((tour) => tour.enabled);\n  const {\n    enabled, checkpoints = [], startingIndex, onEscape, onEnd, onDismiss: tourOnDismiss,\n    advanceButtonText: tourAdvanceButtonText, dismissButtonText: tourDismissButtonText,\n    endButtonText: tourEndButtonText,\n  } = tourValue || {};\n  const [currentCheckpointData, setCurrentCheckpointData] = useState(null);\n  const [index, setIndex] = useState(0);\n  const [isTourEnabled, setIsTourEnabled] = useState(false);\n  const [prunedCheckpoints, setPrunedCheckpoints] = useState([]);\n  const {\n    title, body, onAdvance, onDismiss, advanceButtonText, dismissButtonText,\n    endButtonText, placement, target, showDismissButton,\n  } = currentCheckpointData || {};\n\n  /**\n   * Takes a list of checkpoints and verifies that each target string provided is\n   * an element in the DOM.\n   */\n  const pruneCheckpoints = (checkpointList) => {\n    const checkpointsWithRenderedTargets = checkpointList.filter(\n      (checkpoint) => !!document.querySelector(checkpoint.target),\n    );\n    setPrunedCheckpoints(checkpointsWithRenderedTargets);\n  };\n\n  useEffect(() => {\n    if (enabled && checkpoints) {\n      setIsTourEnabled(enabled);\n      pruneCheckpoints(checkpoints);\n      setIndex(startingIndex || 0);\n    }\n  }, [enabled, checkpoints, startingIndex]);\n\n  useEffect(() => {\n    if (isTourEnabled && prunedCheckpoints.length) {\n      setCurrentCheckpointData(prunedCheckpoints[index]);\n    }\n  }, [index, isTourEnabled, prunedCheckpoints]);\n\n  useEffect(() => {\n    const handleEsc = (event) => {\n      if (event.keyCode === 27) {\n        setIsTourEnabled(false);\n        if (onEscape) {\n          onEscape();\n        }\n      }\n    };\n    global.addEventListener('keydown', handleEsc);\n\n    return () => {\n      global.removeEventListener('keydown', handleEsc);\n    };\n  }, [onEscape]);\n\n  if (!tourValue || !currentCheckpointData || !isTourEnabled) {\n    return null;\n  }\n\n  const handleAdvance = () => {\n    setIndex(index + 1);\n    if (onAdvance) {\n      onAdvance();\n    }\n  };\n\n  const handleDismiss = () => {\n    setIndex(0);\n    setIsTourEnabled(false);\n    if (onDismiss) {\n      onDismiss();\n    } else {\n      tourOnDismiss();\n    }\n    setCurrentCheckpointData(null);\n  };\n  /* eslint-disable */\n  /**\n   * Takes the final checkpoint array index value and looks for an existing onEnd callback.\n   * \n   * If an onEnd callback exist on checkpointIndex value and it is the final checkpoint \n   * in the array, the onEnd callback will be called for the parent, and individual onEnd object. \n   * \n   * @param {Integer} checkpointIndex \n   */\n  /* eslint-enable */\n  const handleEnd = (checkpointIndex) => {\n    setIndex(0);\n    setIsTourEnabled(false);\n    if (prunedCheckpoints[checkpointIndex].onEnd) {\n      prunedCheckpoints[checkpointIndex].onEnd();\n    } else if (onEnd) {\n      onEnd(prunedCheckpoints[checkpointIndex]);\n    }\n    setCurrentCheckpointData(null);\n  };\n  return (\n    <Checkpoint\n      advanceButtonText={advanceButtonText || tourAdvanceButtonText}\n      body={body}\n      currentCheckpointData={currentCheckpointData}\n      dismissButtonText={dismissButtonText || tourDismissButtonText}\n      endButtonText={endButtonText || tourEndButtonText}\n      index={index}\n      onAdvance={handleAdvance}\n      onDismiss={handleDismiss}\n      onEnd={handleEnd}\n      placement={placement}\n      target={target}\n      title={title}\n      totalCheckpoints={prunedCheckpoints.length}\n      showDismissButton={showDismissButton}\n      ref={ref}\n    />\n  );\n});\n\nProductTour.defaultProps = {\n  tours: {\n    advanceButtonText: '',\n    checkpoints: {\n      advanceButtonText: '',\n      body: '',\n      dismissButtonText: '',\n      endButtonText: '',\n      onAdvance: () => {},\n      onDismiss: () => {},\n      placement: 'top',\n      title: '',\n      showDismissButton: undefined,\n    },\n    dismissButtonText: '',\n    endButtonText: '',\n    onDismiss: () => {},\n    onEnd: () => {},\n    onEscape: () => {},\n    startingIndex: 0,\n  },\n};\n\nProductTour.propTypes = {\n  tours: PropTypes.arrayOf(PropTypes.shape({\n    /** The text displayed on all buttons used to advance the tour. */\n    advanceButtonText: PropTypes.node,\n    /** An array comprised of checkpoint objects supporting the following values: */\n    checkpoints: PropTypes.arrayOf(PropTypes.shape({\n      /** The text displayed on the button used to advance the tour for the given Checkpoint\n       * (overrides the* `advanceButtonText` defined in the parent tour object). */\n      advanceButtonText: PropTypes.node,\n      /** The text displayed in the body of the Checkpoint */\n      body: PropTypes.node,\n      /** The text displayed on the button used to dismiss the tour for the given Checkpoint\n       * (overrides the `dismissButtonText` defined in the parent tour object). */\n      dismissButtonText: PropTypes.node,\n      /** The text displayed on the button used to end the tour for the given Checkpoint\n       * (overrides the `endButtonText` defined in the parent tour object). */\n      endButtonText: PropTypes.node,\n      /** A function that runs when triggering the `onClick` event of the advance\n       * button for the given Checkpoint. */\n      onAdvance: PropTypes.func,\n      /** A function that runs when triggering the `onClick` event of the dismiss\n       * button for the given Checkpoint (overrides the `onDismiss` function defined in the parent tour object). */\n      onDismiss: PropTypes.func,\n      /** A function that runs when triggering the `onClick` event of the advance\n      * button if the given Checkpoint is the only or last Checkpoint in a tour. */\n      onEnd: PropTypes.func,\n      /** A string that dictates the alignment of the Checkpoint around its target. */\n      placement: PropTypes.oneOf([\n        'top', 'top-start', 'top-end', 'right-start', 'right', 'right-end',\n        'left-start', 'left', 'left-end', 'bottom', 'bottom-start', 'bottom-end',\n      ]),\n      /** The CSS selector for the Checkpoint's desired target. */\n      target: PropTypes.string.isRequired,\n      /** The text displayed in the title of the Checkpoint */\n      title: PropTypes.node,\n      /** Enforces visibility of the dismiss button under all circumstances */\n      showDismissButton: PropTypes.bool,\n    })),\n    /** The text displayed on the button used to dismiss the tour. */\n    dismissButtonText: PropTypes.node,\n    /** Whether the tour is enabled. If there are multiple tours defined, only one should be enabled at a time. */\n    enabled: PropTypes.bool.isRequired,\n    /** The text displayed on the button used to end the tour. */\n    endButtonText: PropTypes.node,\n    /** A function that runs when triggering the `onClick` event of the dismiss button. */\n    onDismiss: PropTypes.func,\n    /** A function that runs when triggering the `onClick` event of the end button. */\n    onEnd: PropTypes.func,\n    /** A function that runs when pressing the Escape key. */\n    onEscape: PropTypes.func,\n    /** The index of the desired `Checkpoint` to render when the tour starts. */\n    startingIndex: PropTypes.number,\n    /** The ID of the tour */\n    tourId: PropTypes.string.isRequired,\n  })),\n};\n\nexport default ProductTour;\n"],"mappings":"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","ignoreList":[]}