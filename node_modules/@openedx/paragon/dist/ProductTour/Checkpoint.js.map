{"version":3,"file":"Checkpoint.js","names":["React","useEffect","useState","useMediaQuery","PropTypes","createPopper","FormattedMessage","breakpoints","CheckpointActionRow","CheckpointBody","CheckpointBreadcrumbs","CheckpointTitle","messages","Checkpoint","forwardRef","_ref","ref","body","index","placement","target","title","totalCheckpoints","props","_objectWithoutProperties","_excluded","_useState","_useState2","_slicedToArray","checkpointVisible","setCheckpointVisible","isMobile","maxWidth","small","targetElement","document","querySelector","checkpoint","checkpointPopper","strategy","modifiers","name","options","padding","offset","tetherOffset","forceUpdate","targetOffset","getBoundingClientRect","top","bottom","global","innerHeight","includes","scrollTo","behavior","button","focus","isLastCheckpoint","isOnlyCheckpoint","createElement","id","className","role","style","visibility","pointerEvents","_extends","topPositionText","values","step","currentIndex","bottomPositionText","defaultProps","advanceButtonText","dismissButtonText","endButtonText","showDismissButton","undefined","propTypes","node","number","isRequired","onAdvance","func","onDismiss","onEnd","oneOf","string","bool"],"sources":["../../src/ProductTour/Checkpoint.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useMediaQuery } from 'react-responsive';\nimport PropTypes from 'prop-types';\nimport { createPopper } from '@popperjs/core';\nimport { FormattedMessage } from 'react-intl';\n\nimport breakpoints from '../utils/breakpoints';\n\nimport CheckpointActionRow from './CheckpointActionRow';\nimport CheckpointBody from './CheckpointBody';\nimport CheckpointBreadcrumbs from './CheckpointBreadcrumbs';\nimport CheckpointTitle from './CheckpointTitle';\nimport messages from './messages';\n\nconst Checkpoint = React.forwardRef(({\n  body,\n  index,\n  placement,\n  target,\n  title,\n  totalCheckpoints,\n  ...props\n}, ref) => {\n  const [checkpointVisible, setCheckpointVisible] = useState(false);\n  const isMobile = useMediaQuery({ maxWidth: breakpoints.small.maxWidth });\n\n  useEffect(() => {\n    const targetElement = document.querySelector(target);\n    const checkpoint = document.querySelector('#pgn__checkpoint');\n    if (targetElement && checkpoint) {\n      // Use the Popper library to translate the Checkpoint to its target's coordinates\n      const checkpointPopper = createPopper(targetElement, checkpoint, {\n        placement: isMobile ? 'top' : placement,\n        strategy: 'fixed',\n        modifiers: [\n          {\n            name: 'arrow',\n            options: {\n              padding: 25,\n            },\n          },\n          {\n            name: 'offset',\n            options: {\n              offset: [0, 20],\n            },\n          },\n          {\n            name: 'preventOverflow',\n            options: {\n              padding: 20,\n              tetherOffset: 35,\n            },\n          },\n        ],\n      });\n      setCheckpointVisible(true);\n      if (checkpointPopper) {\n        checkpointPopper.forceUpdate();\n      }\n    }\n  }, [target, isMobile, placement]);\n\n  useEffect(() => {\n    if (checkpointVisible) {\n      // Scroll the Checkpoint into view once its rendered\n      const targetElement = document.querySelector(target);\n      let targetOffset = targetElement.getBoundingClientRect().top;\n      if ((targetOffset < 0) || (targetElement.getBoundingClientRect().bottom > global.innerHeight)) {\n        if (placement.includes('top')) {\n          if (targetOffset < 0) {\n            targetOffset *= -1;\n          }\n          targetOffset -= 280;\n        } else {\n          targetOffset -= 80;\n        }\n\n        global.scrollTo({\n          top: targetOffset, behavior: 'smooth',\n        });\n      }\n\n      const button = document.querySelector('.pgn__checkpoint-button_advance');\n      button.focus();\n    }\n  }, [target, checkpointVisible, placement]);\n\n  const isLastCheckpoint = index + 1 === totalCheckpoints;\n  const isOnlyCheckpoint = totalCheckpoints === 1;\n\n  return (\n    <div\n      id=\"pgn__checkpoint\"\n      className=\"pgn__checkpoint\"\n      aria-labelledby=\"pgn__checkpoint-title\"\n      ref={ref}\n      role=\"dialog\"\n      style={{ visibility: checkpointVisible ? 'visible' : 'hidden', pointerEvents: checkpointVisible ? 'auto' : 'none' }}\n    >\n      <span className=\"sr-only\">\n        <FormattedMessage\n          {...messages.topPositionText}\n          values={{ step: index + 1 }}\n        />\n      </span>\n      {(title || !isOnlyCheckpoint) && (\n        <div className=\"pgn__checkpoint-header\">\n          <CheckpointTitle>{title}</CheckpointTitle>\n          <CheckpointBreadcrumbs currentIndex={index} totalCheckpoints={totalCheckpoints} />\n        </div>\n      )}\n      <CheckpointBody>{body}</CheckpointBody>\n      <CheckpointActionRow\n        isLastCheckpoint={isLastCheckpoint}\n        index={index}\n        {...props}\n      />\n      <div id=\"pgn__checkpoint-arrow\" data-popper-arrow />\n      <span className=\"sr-only\">\n        <FormattedMessage\n          {...messages.bottomPositionText}\n          values={{ step: index + 1 }}\n        />\n      </span>\n    </div>\n  );\n});\n\nCheckpoint.defaultProps = {\n  advanceButtonText: null,\n  body: null,\n  dismissButtonText: null,\n  endButtonText: null,\n  placement: 'top',\n  title: null,\n  showDismissButton: undefined,\n};\n\nCheckpoint.propTypes = {\n  /** The text displayed on the button used to advance the tour for the given Checkpoint. */\n  advanceButtonText: PropTypes.node,\n  /** The text displayed in the body of the Checkpoint */\n  body: PropTypes.node,\n  /** The text displayed on the button used to dismiss the tour for the given Checkpoint. */\n  dismissButtonText: PropTypes.node,\n  /** The text displayed on the button used to end the tour for the given Checkpoint. */\n  endButtonText: PropTypes.node,\n  /** The current index of the given Checkpoint */\n  index: PropTypes.number.isRequired,\n  /** A function that runs when triggering the `onClick` event of the advance\n   * button for the given Checkpoint. */\n  onAdvance: PropTypes.func.isRequired,\n  /** A function that runs when triggering the `onClick` event of the dismiss\n   * button for the given Checkpoint. */\n  onDismiss: PropTypes.func.isRequired,\n  /** A function that runs when triggering the `onClick` event of the advance\n   * button if the given Checkpoint is the only or last Checkpoint in a tour. */\n  onEnd: PropTypes.func.isRequired,\n  /** A string that dictates the alignment of the Checkpoint around its target. */\n  placement: PropTypes.oneOf([\n    'top', 'top-start', 'top-end', 'right-start', 'right', 'right-end',\n    'left-start', 'left', 'left-end', 'bottom', 'bottom-start', 'bottom-end',\n  ]),\n  /** The CSS selector for the Checkpoint's desired target. */\n  target: PropTypes.string.isRequired,\n  /** The text displayed in the title of the Checkpoint */\n  title: PropTypes.node,\n  /** The total number of Checkpoints in a tour */\n  totalCheckpoints: PropTypes.number.isRequired,\n  /** Enforces visibility of the dismiss button under all circumstances */\n  showDismissButton: PropTypes.bool,\n};\n\nexport default Checkpoint;\n"],"mappings":"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","ignoreList":[]}